\startenvironment env_cards

\setupinteraction[title=Constellation Cards, author=Bill Garrett]
\setupbackend[format=PDF/X-1a:2003, intent=SWOP2006_Coated5v2.icc]

% Tarot cards are 2.75" x 4.75" with a 1/8th inch bleed and margin
% \definepapersize[tarot][width=3in, height=5in]
\definepapersize[tarot][width=3in, height=5in]
\setuppapersize[tarot]

\def\TarotMargin{0.25in}
\setuplayout    [page] [topspace=\TarotMargin,backspace=\TarotMargin]
\setuplayout    [page]
\setuplayout    [location=middle]
\setuphead[chapter][header=high, footer=none]

% DEBUG
% \showframe
% \setupbackgrounds[header, footer][background=color, backgroundcolor=blue]

% \showlayout
% \showsetups
% \showmakeup
% \showframe

% Font

\starttypescript [neuton]
  \definefontsynonym[Neuton-Regular]    [file:Neuton-Regular]
  \definefontsynonym[Neuton-Italic]     [file:Neuton-Italic]
  \definefontsynonym[Neuton-Bold]       [file:Neuton-Bold]
  \definefontsynonym[Neuton-BoldItalic] [file:Neuton-Light]
\stoptypescript

\starttypescript [neuton]
  \setups[font:fallback:serif]
  \definefontsynonym[Serif]                [Neuton-Regular]    [features=default]
  \definefontsynonym[SerifItalic]          [Neuton-Italic]     [features=default]
  \definefontsynonym[SerifBold]            [Neuton-Bold]       [features=default]
  \definefontsynonym[SerifBoldItalic]      [Neuton-BoldItalic] [features=default]
\stoptypescript

\starttypescript [neuton]
  \definetypeface [neuton]    [rm] [serif] [neuton]    [default]
\stoptypescript

\setupbodyfont[neuton]
\setupbodyfont[12pt]

% No page numbering
\setuppagenumbering[location=]

% Inter-paragraph spacing
\setupwhitespace[halfline]

\definenarrower[NarrowRules][left=1cm,right=1cm]

% Macros for card header and rule text
\define[1]\constellationtitle{\dontleavehmode{\midaligned{\tfa\bf\underbar #1}}}
\define[1]\constellationstack{\dontleavehmode{\midaligned{\tfx #1}}}
\define[1]\constellationquote{\italic{#1}}
\define[1]\constellationrule{\startNarrowRules[left,right] \startalignment[middle] \italic{#1} \stopalignment \stopNarrowRules}

\stopenvironment
